<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cadastro de alunos</title>
<script>
class Aluno {
    constructor(nome, idade, curso, notaFinal) {
        this._nome = nome;
        this._idade = idade;
        this._curso = curso;
        this._notaFinal = notaFinal;
    }

    /* Getters e setters */
    get nome() {
        return this._nome;
    }

    set nome(novoNome) {
        this._nome = novoNome;
    }

    get idade() {
        return this._idade;
    }

    set idade(novaIdade) {
        this._idade = novaIdade;
    }

    get curso() {
        return this._curso;
    }

    set curso(novoCurso) {
        this._curso = novoCurso;
    }

    get notaFinal() {
        return this._notaFinal;
    }

    set notaFinal(novaNotaFinal) {
        this._notaFinal = novaNotaFinal;
    }
    /* Fim getters e setters*/

    isAprovado() {
        return this._notaFinal >= 7;
    }

    toString() {
        return `
        Nome: ${this._nome};
        Idade: ${this._idade};
        Curso: ${this._curso};
        Nota Final: ${this._notaFinal};
        `
    }
}

document.addEventListener("DOMContentLoaded", function() {
    const botaoSubmit = document.querySelector("#cadastro");
    const tabela = document.querySelector("#table");
    let registros = [];

    function rebuildTable() {
        let html = `
        <tr>
            <th>Nome</th>
            <th>Idade</th>
            <th>Curso</th>
            <th>Nota Final</th>
            <th>Aprovado</th>
            <th></th>
            <th></th>
        </tr>`;

        registros.forEach((r, i) => {
            html += `
            <tr>
                <td>${r.nome}</td>
                <td>${r.idade}</td>
                <td>${r.curso}</td>
                <td>${r.notaFinal}</td>
                <td>${r.isAprovado()}</td>
                <td><button type="button" class="editar" data-index="${i}">Editar</button></td>
                <td><button type="button" class="excluir" data-index="${i}">Excluir</button></td>
            </tr>`;
        });
        tabela.innerHTML = html;
    }

    botaoSubmit.addEventListener("click", function() {
        const nome = document.querySelector("#nome").value;
        const idade = document.querySelector("#idade").value;
        const curso = document.querySelector("#curso").value;
        const nota = document.querySelector("#nota").value

        registros.push(new Aluno(nome, idade, curso, nota));
        rebuildTable();
    });

    tabela.addEventListener("click", function(e) {
        const index = parseInt(e.target.dataset.index);

        if (e.target.classList.contains("editar")) {
            const row = e.target.closest("tr");
            const r = registros[index];
            row.innerHTML = `
                <td><input type="text" id="nome-${index}" value="${r.nome}"></td>
                <td><input type="number" id="idade-${index}" value="${r.idade}"></td>
                <td>
                    <select id="curso-${index}">
                        <option value="JavaScript" ${r.curso === "JavaScript" ? "selected" : ""}>JavaScript</option>
                        <option value="Python" ${r.curso === "Python" ? "selected" : ""}>Python</option>
                        <option value="Java" ${r.curso === "Java" ? "selected" : ""}>Java</option>
                    </select>
                </td>
                <td><input type="number" id="nota-${index}" value="${r.notaFinal}"></td>
                <td><button type="button" class="confirmar" data-index="${index}">Confirmar</button></td>
                <td></td>
            `;
        }

        if (e.target.classList.contains("confirmar")) {
            const novoNome = document.querySelector(`#nome-${index}`).value;
            const novaIdade = document.querySelector(`#idade-${index}`).value;
            const novoCurso = document.querySelector(`#curso-${index}`).value;
            const novaNota = document.querySelector(`#nota-${index}`).value;
            registros[index] = new Aluno(novoNome, novaIdade, novoCurso, novaNota);
            rebuildTable();
        }

        if (e.target.classList.contains("excluir")) {
            registros.splice(index, 1);
            rebuildTable();
        }
    });
});

</script>
</head>
<body>
<form>
    <label>Nome</label>
    <input type="text" id="nome"><br>

    <label>Idade</label>
    <input type="number" id="idade"><br>

    <label>Curso</label>
    <select id="curso">
        <option value="JavaScript">JavaScript</option>
        <option value="Python">Python</option>
        <option value="Java">Java</option>
    </select><br>
    <label>Nota Final</label>
    <input type="number" id="nota"><br>

    <button type="button" id="cadastro">Cadastrar</button>
</form>

<table id="table">
    <tr>
        <th>Nome</th>
        <th>Idade</th>
        <th>Curso</th>
        <th>Nota Final</th>
        <th>Aprovado</th>
        <th></th>
        <th></th>
    </tr>
</table>
</body>
</html>